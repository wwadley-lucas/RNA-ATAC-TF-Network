# Output Files Description

This document describes all output files generated by RNA-ATAC-TF-Network.

## Directory Structure

```
output/
├── <contrast>/              # One directory per contrast
│   ├── tables/              # Data tables
│   ├── plots/               # Visualizations
│   └── cytoscape/           # Cytoscape-compatible files
└── tf_focus/                # TF-focused outputs
    ├── tables/
    └── plots/
```

---

## General Network Tables

Located in: `output/<contrast>/tables/`

### `tf_gene_edges_<contrast>.tsv`

TF→gene regulatory edges with integrated scores.

| Column | Type | Description |
|--------|------|-------------|
| `tf` | string | Transcription factor name |
| `gene` | string | Target gene symbol |
| `edge_score` | float | Integrated regulatory score (TF × accessibility × weight) |
| `edge_score_norm` | float | Normalized edge score (0-1) |
| `n_peaks` | int | Number of peaks linking TF to gene |
| `tf_activity` | float | Differential TF binding score |
| `atac_log2fc` | float | log2 fold-change in accessibility |
| `rna_log2fc` | float | log2 fold-change in expression |
| `rna_pvalue` | float | P-value for differential expression |

**Usage**: Main input for network visualization and downstream analysis.

---

### `tf_gene_nodes_<contrast>.tsv`

Node attributes for network visualization.

| Column | Type | Description |
|--------|------|-------------|
| `node` | string | Node name (TF or gene symbol) |
| `node_type` | string | "TF" or "gene" |
| `tf_activity` | float | TF activity score (NA for genes) |
| `expression` | float | log2FC expression (for genes) |
| `direction` | int | Sign of change (-1, 0, or 1) |
| `degree` | int | Number of connections |

**Usage**: Provides node attributes for visualization styling.

---

### `tf_activity_<contrast>.tsv`

TF-level differential binding scores.

| Column | Type | Description |
|--------|------|-------------|
| `tf` | string | Transcription factor name |
| `tf_activity` | float | Differential binding score (case - control) |
| `tf_pvalue` | float | P-value for differential binding |
| `direction` | int | Sign of activity (-1 or 1) |

**Usage**: Identify which TFs are differentially active between conditions.

---

### `rna_de_<contrast>.tsv`

RNA differential expression results.

| Column | Type | Description |
|--------|------|-------------|
| `gene` | string | Gene symbol |
| `rna_log2fc` | float | log2 fold-change (case/control) |
| `rna_pvalue` | float | P-value from t-test |

**Usage**: Reference for gene-level expression changes.

---

### `peak2gene_<contrast>.tsv`

Peak-to-gene mapping with distance weights.

| Column | Type | Description |
|--------|------|-------------|
| `peak_id` | string | Peak identifier (chr:start-end) |
| `gene` | string | Assigned gene symbol |
| `dist_to_tss` | int | Distance to transcription start site |
| `weight` | float | Distance-based weight (0-1) |
| `annotation` | string | Peak annotation (Promoter, Intron, etc.) |

**Usage**: Reference for peak-gene assignments used in edge scoring.

---

## General Network Plots

Located in: `output/<contrast>/plots/`

### `network_<contrast>_<PATHWAY>.png/pdf`

Pathway-specific network visualizations.

**Visual encoding**:
- **Node shape**: Diamond = TF, Circle = gene
- **Node color**: Red = upregulated, Blue = downregulated
- **Node size**: Based on degree (connections)
- **Edge opacity**: Based on edge score

**File naming**: `network_NvT_HALLMARK_INFLAMMATORY_RESPONSE.png`

---

### `emap_<contrast>.png/pdf`

Enrichment map showing pathway similarities.

**Visual encoding**:
- **Nodes**: Pathways
- **Node size**: Number of regulated genes
- **Node color**: Percentage of pathway regulated
- **Edges**: Jaccard similarity between pathway gene sets

---

### `pathway_stats_<contrast>.tsv`

Statistics for pathway enrichment.

| Column | Type | Description |
|--------|------|-------------|
| `pathway` | string | Pathway name |
| `n_overlap` | int | Number of regulated genes in pathway |
| `n_pathway` | int | Total genes in pathway |
| `pct_overlap` | float | Percentage of pathway regulated |
| `genes` | string | Comma-separated list of overlapping genes |

---

## Cytoscape Files

Located in: `output/<contrast>/cytoscape/`

### `cytoscape_edges_<contrast>.tsv`

Edge list for Cytoscape import.

| Column | Description |
|--------|-------------|
| `tf` | Source node (TF) |
| `gene` | Target node (gene) |
| `edge_score` | Edge weight |
| `rna_log2fc` | Target expression |
| `n_peaks` | Number of supporting peaks |
| `interaction` | Interaction type ("regulates") |

**Import**: File → Import → Network from File

---

### `cytoscape_nodes_<contrast>.tsv`

Node attributes for Cytoscape import.

| Column | Description |
|--------|-------------|
| `node` | Node identifier |
| `node_type` | "TF" or "gene" |
| `tf_activity` | TF activity score |
| `expression` | Gene expression log2FC |
| `degree` | Number of connections |

**Import**: File → Import → Table from File → Import Data as Node Table Columns

---

## TF-Focused Tables

Located in: `output/tf_focus/tables/`

### `tf_focus_edges_<TF>_<contrast>.tsv`

Cascade network edges for specific TF.

| Column | Type | Description |
|--------|------|-------------|
| `source` | string | Source node (TF) |
| `target` | string | Target node (gene or secondary TF) |
| `binding_score` | float | TF binding strength at site |
| `binding_score_scaled` | float | Normalized binding score (0-1) |
| `accessibility_diff` | float | Differential accessibility |
| `accessibility_diff_scaled` | float | Normalized accessibility (-1 to 1) |
| `n_sites` | int | Number of binding sites |
| `layer` | int | Network layer (1 = direct, 2 = cascade) |
| `source_type` | string | "TF" |
| `target_type` | string | "TF" or "gene" |

---

### `tf_focus_nodes_<TF>_<contrast>.tsv`

Cascade network node attributes.

| Column | Type | Description |
|--------|------|-------------|
| `node` | string | Node name |
| `node_type` | string | "TF" or "gene" |
| `layer` | int | Network layer (0=primary, 1=direct, 2=cascade) |
| `expression` | float | log2FC expression |
| `expression_pval` | float | Expression p-value |
| `is_primary` | bool | Whether this is the primary TF |
| `out_degree` | int | Number of outgoing edges |
| `in_degree` | int | Number of incoming edges |
| `degree` | int | Total degree |

---

## TF-Focused Plots

Located in: `output/tf_focus/plots_<TF>_<contrast>/`

### `tf_focus_<TF>.png/pdf`

Hierarchical cascade visualization (Sugiyama layout).

**Visual encoding**:
- **Node shape**: Diamond = TF, Circle = gene
- **Node color**: Expression log2FC (red=up, blue=down)
- **Node size**: Based on layer (larger = closer to primary TF)
- **Edge linetype**: Binding strength (dotted=weak, solid=strong)
- **Edge width**: Chromatin accessibility change

**Dimensions**: 14" × 12" (default)

---

### `tf_focus_<TF>_circular.png/pdf`

Radial layout with primary TF at center.

**Layout**:
- Center: Primary TF (Layer 0)
- Inner ring: Direct targets (Layer 1)
- Outer ring: Cascade targets (Layer 2)

**Dimensions**: 14" × 14" (default)

---

### `tf_focus_<TF>_compact.png/pdf`

Small version for figure panels.

**Dimensions**: 4" × 3.5"

**Features**:
- Smaller text
- Minimal legends
- Simplified edges

---

### `tf_focus_<TF>_circular_compact.png/pdf`

Compact circular layout for figure panels.

**Dimensions**: 4" × 4"

---

## File Formats

### Tab-separated values (TSV)

- All table outputs use tab (`\t`) as delimiter
- UTF-8 encoding
- Header row included
- No row names in output (use first column)

### Image files

- **PNG**: 300 DPI, suitable for presentations and web
- **PDF**: Vector format, suitable for publication

### Cytoscape compatibility

Files are formatted for direct import into Cytoscape:
1. Import edge file as network
2. Import node file as node table
3. Apply visual styles using column mappings
